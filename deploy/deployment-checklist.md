# Rigel TCP代理系统部署检查清单

## 📋 部署前检查

### 🖥️ 本地环境检查
- [ ] Windows 10/11 操作系统
- [ ] PowerShell 5.0+ 已安装
- [ ] Go 1.19+ 已安装并配置
- [ ] SSH客户端可用 (OpenSSH或PuTTY)
- [ ] 网络连接正常

### 🌐 服务器环境检查
- [ ] 3台Linux服务器已准备 (Ubuntu 20.04+推荐)
- [ ] 所有服务器具有Root访问权限
- [ ] 服务器间网络连通正常
- [ ] 防火墙已开放8080端口
- [ ] SSH服务运行正常

### 📁 文件准备检查
- [ ] 源代码已下载到本地
- [ ] `deploy/` 目录结构完整
- [ ] 配置文件已创建 (proxy1.yaml, proxy2.yaml, target.yaml)
- [ ] 部署脚本权限正确

## 🔨 编译检查

### Windows版本编译
```bash
go build -o deploy/bin/rigel-proxy.exe cmd/proxy/main.go
```
- [ ] 编译成功，无错误信息
- [ ] 生成文件 `deploy/bin/rigel-proxy.exe`
- [ ] 文件大小合理 (通常5-20MB)

### Linux版本编译
```bash
set GOOS=linux
set GOARCH=amd64  
go build -o deploy/bin/rigel-proxy-linux cmd/proxy/main.go
```
- [ ] 编译成功，无错误信息
- [ ] 生成文件 `deploy/bin/rigel-proxy-linux`
- [ ] 文件大小合理 (通常5-20MB)

### 测试客户端编译
```bash
go build -o deploy/bin/rigel-client.exe deploy/real-world-client.go
```
- [ ] 编译成功，无错误信息
- [ ] 生成文件 `deploy/bin/rigel-client.exe`

## 🚀 部署执行检查

### 第1步：连接测试
```powershell
.\deploy\scripts\deploy-fixed.ps1
```
- [ ] SSH连接到Proxy1成功
- [ ] SSH连接到Proxy2成功  
- [ ] SSH连接到Target成功
- [ ] 所有服务器响应正常

### 第2步：环境初始化
- [ ] 目录创建成功 `/opt/rigel/{bin,config,logs}`
- [ ] 系统包更新完成
- [ ] 防火墙配置完成
- [ ] UFW规则添加成功

### 第3步：文件上传
- [ ] 程序文件上传到所有服务器
- [ ] 配置文件上传到所有服务器
- [ ] 文件权限设置正确 (可执行)
- [ ] 文件大小验证正确

### 第4步：服务启动
- [ ] Proxy1服务启动成功
- [ ] Proxy2服务启动成功
- [ ] Target服务启动成功
- [ ] 所有进程运行正常

## 🔍 部署验证检查

### 网络连通性测试
```powershell
Test-NetConnection -ComputerName <server_ip> -Port 8080
```
- [ ] Proxy1端口8080连通
- [ ] Proxy2端口8080连通
- [ ] Target端口8080连通

### 进程状态检查
```bash
ssh root@<server_ip> "ps aux | grep rigel-proxy"
```
- [ ] Proxy1进程运行正常
- [ ] Proxy2进程运行正常
- [ ] Target进程运行正常

### 日志检查
```bash
ssh root@<server_ip> "tail -5 /opt/rigel/logs/rigel.log"
```
- [ ] Proxy1日志正常，无错误
- [ ] Proxy2日志正常，无错误
- [ ] Target日志正常，无错误

## 🧪 功能测试检查

### 单次测试
```bash
go run deploy/single-test.go
```
- [ ] 连接建立成功
- [ ] 数据传输成功
- [ ] 无错误信息
- [ ] 延迟在合理范围

### 完整测试
```bash
go run deploy/real-world-client.go
```
- [ ] 测试1: 简单消息传输 - 成功
- [ ] 测试2: 带时间戳消息 - 成功
- [ ] 测试3: 大数据传输 - 成功
- [ ] 测试4: 连续传输测试 - 成功

### 性能验证
- [ ] 传输延迟 < 10ms
- [ ] 数据完整性 100%
- [ ] 连接成功率 100%
- [ ] 支持大数据包 (>1KB)

## 🔧 故障排除检查

### 常见问题检查
- [ ] SSH连接问题已解决
- [ ] 端口连接问题已解决
- [ ] 程序启动问题已解决
- [ ] 配置文件问题已解决

### 修复脚本验证
```powershell
.\deploy\scripts\fix-target.ps1
```
- [ ] Target修复脚本可用
- [ ] 验证脚本可用
- [ ] 所有修复措施有效

## 📊 监控设置检查

### 基础监控
- [ ] 进程监控设置
- [ ] 端口监控设置
- [ ] 日志监控设置
- [ ] 资源使用监控设置

### 告警设置
- [ ] 服务停止告警
- [ ] 连接失败告警
- [ ] 性能异常告警
- [ ] 磁盘空间告警

## 📚 文档检查

### 部署文档
- [ ] README.md 完整
- [ ] 部署指南详细
- [ ] 故障排除文档完整
- [ ] 配置说明清晰

### 测试报告
- [ ] 测试报告已生成
- [ ] 执行总结已完成
- [ ] 性能数据已记录
- [ ] 问题分析已完成

## ✅ 最终验证

### 系统整体检查
- [ ] 所有服务器状态正常
- [ ] 网络连通性良好
- [ ] 功能测试全部通过
- [ ] 性能指标达标

### 生产就绪检查
- [ ] 监控系统已部署
- [ ] 备份策略已制定
- [ ] 运维文档已准备
- [ ] 团队培训已完成

### 签收确认
- [ ] 开发团队确认
- [ ] 测试团队确认
- [ ] 运维团队确认
- [ ] 项目经理确认

---

## 📝 检查记录

**检查日期**: ___________  
**检查人员**: ___________  
**检查结果**: [ ] 通过 [ ] 需要修复  
**备注**: ___________

**最终确认**:
- 开发负责人: ___________  日期: ___________
- 测试负责人: ___________  日期: ___________  
- 运维负责人: ___________  日期: ___________
- 项目经理: ___________    日期: ___________

---

**文档版本**: v1.0  
**最后更新**: 2025-01-08
